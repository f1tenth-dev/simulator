<?xml version='1.0'?>

<launch>

    <!-- global variables -->
    <arg name='car_name' default='car_1' />
    <arg name='listen_offboard' default='true' />
    <arg name='keyboard_control' default='false'/>
    <arg name='visualize' default='false'/>

    <!-- launch rviz with mapping configuration -->
    <group if='$(arg visualize)'>
        <node name='remote_visualization' pkg='rviz' type='rviz' args='-d $(find f1tenth-sim)/rviz/$(arg car_name).rviz' />
    </group>
    <group ns='$(arg car_name)'>
        <!-- keyboard teleop -->
        <group if='$(arg keyboard_control)'>
            <node name = 'keyboard_teleop' pkg = 'f1tenth-sim' type = 'keyboard_teleop.py' 
                args = '$(arg car_name)' output = 'screen'/>
        </group>
        
        <!-- joy_node using F310/F710 -->
        <group unless='$(arg keyboard_control)'>
            <node name='joy_node' pkg='joy' type='joy_node'>
                <param name='autorepeat_rate' value='20.0' />
	        </node> 
        </group>
        
        <!-- bring up command multiplexer -->
        <node name='command_multiplexer' pkg='f1tenth-sim' type='command_multiplexer.py' args='$(arg car_name)
                                 $(arg listen_offboard) $(arg keyboard_control)' output='screen' />

    </group>

</launch>
